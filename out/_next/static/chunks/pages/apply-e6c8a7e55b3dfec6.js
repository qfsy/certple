(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[805],{6652:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apply",function(){return a(4076)}])},8103:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return depend}});var _components_main__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8841);function depend(){let Version="1.0.230820";console.log("LICENSE: GPL-3.0, https://github.com/xiangyuecn/ACME-HTML-Web-Browser-Client/blob/main/LICENSE");var acmeReadDirGotoCORSInit=function(){if(window.IsReadDirGotoCORS){var e=$(".acmeReadDirGotoCORSState").show().html('\n<div style="color:#cb1d1d">\n<span class="langCN">本客户端正在以跨域兼容模式运行，请按正常流程操作即可，目标ACME服务URL='.concat(window.Default_ACME_URL,'</span>\n<span class="langEN"></span>\n</div>\n    '));LangReview(e)}},acmeReadDirGotoCORS=function(){var e="// "+Lang("请复制本代码到打开的ACME服务URL页面的浏览器控制台中运行。","",!0)+"\n\nvar Default_ACME_URL="+JSON.stringify(ACME.URL)+";\nvar IsReadDirGotoCORS=true;\nvar PageRawHTML=`"+PageRawHTML.replace(/\\/g,"\\\\").replace(/`/g,"\\`").replace(/\$\{/g,"$\\{")+"`;";e+="\n("+(function(){console.clear(),document.head.innerHTML=/<head[^>]*>([\S\s]+?)<\/head>/i.exec(PageRawHTML)[1],document.body.innerHTML=/<body[^>]*>([\S\s]+)<\/body>/i.exec(PageRawHTML)[1];for(var e,t=/<script[^>]*>([\S\s]+?)<\/script>/ig;e=t.exec(PageRawHTML);)eval.call(window,e[1])}).toString()+")()",$(".gotoCORSBox").hide();var t=$(".acmeReadDirState").append('\n<div class="gotoCORSBox" style="padding-top:15px">\n<div class="pd Bold" style="color:red">\n<i class="must">*</i>\n'+(title||'\n<span class="langCN">由于此ACME服务对跨域访问支持不良，</span>\n<span class="langEN"></span>\n<span style="font-size:24px">\n<span class="langCN">请按下面步骤操作：</span>\n<span class="langEN"></span>\n</span>')+'\n</div>\n<div style="padding-left:40px">\n<div class="pd">\n<span class="langCN">1. 请在浏览器中直接打开此ACME服务URL，<a href="'.concat(ACME.URL,'" target="_blank">点此打开</a>；</span>\n<span class="langEN"></span>\n</div>\n<div class="pd">\n<span class="langCN">2. 在上一步打开的页面中打开浏览器控制台（需等页面加载完成后，再按F12键）；</span>\n<span class="langEN"></span>\n</div>\n<div class="pd">\n<span class="langCN">3. 复制以下代码，在第2步打开的浏览器控制台中运行，然后就可以正常申请证书了。</span>\n<span class="langEN"></span>\n</div>\n<div class="pd" style="font-size:13px;color:#aaa">\n<span class="langCN">工作原理：代码内包含了本页面源码，在目标页面内运行后将原样的显示出本客户端，然后按正常流程操作即可，此时已没有跨域问题了（既然打不过，那就加入他们）。</span>\n<span class="langEN"></span>\n</div>\n</div>\n<div style="padding-top:20px">\n<textarea class="gotoCORSText" style="width:100%;height:200px" readonly></textarea>\n</div>\n</div>\n'));$(".gotoCORSText").val(e),LangReview(t)},verifyBoxShow=function(){for(var e=$(".verifyBox").html(""),t=JSON.parse(JSON.stringify(ACME.StepData.auths)),a=ACME.StepData.config.domains,n=0;n<a.length;n++){for(var r=a[n],s=t[r].challenges,i=0;i<s.length;i++){var o=s[i];o.challIdx=i,o.name=ACME.ChallName(o),o._sort=ACME.ChallSort(o)}s.sort(function(e,t){return e._sort.localeCompare(t._sort)});for(var c="",i=0;i<s.length;i++){var l=s[i];c+='\n<label class="fs-14">\n<input type="radio" name="choice_authItem_'.concat(n,'"\nclass="me-2 form-check-input choice_authChall choice_authChall_').concat(n," choice_authChall_").concat(n,"_").concat(i,'"\nvalue="').concat(n,"_").concat(i,'" challidx="').concat(l.challIdx,'">').concat(l.name,"\n</label><br>\n")}e.append('\n<div class="itemBox my-5" style="border: #ccc 1px solid; border-radius: 10px;">\n<div class="pd FlexBox">\n<div style="background-color: #00ff6e25; border: none; padding: 16px 32px; border-radius: 10px 10px 0px 0px;" class="mb-3 fw-bold">'.concat(r,'</div>\n<div class="FlexItem" style="padding: 0 32px;">').concat(c,'</div>\n</div>\n<div class="verifyItemBox_').concat(n,'" style="padding: 0 32px;"></div>\n<div class="verifyItemState_').concat(n,' fs-12 pb-3" style="padding: 0 32px;"></div>\n</div>\n'))}LangReview(e),$(".choice_authChall").bind("click",function(e){var n=e.target.value.split("_"),r=+n[0],s=+n[1],i=t[a[r]],o=i.challenges[s],c=['<div class="mt-1" style="font-size:12px;color:#aaa">'],l="color: #333;";"dns-01"==o.type?(c.push(Lang("前往域名权威 DNS 服务器中添加以下 TXT 记录。"," ")+"</div>"),c.push('<div class="pd FlexBox my-3">\n<div class="fs-14" style="'.concat(l,'">').concat(Lang("主机记录：",""),'</div>\n<div class="FlexItem">\n<input class="form-control fs-13 q-form" readonly value="_acme-challenge.').concat(i.identifier.value,'" />\n<p class="fs-12 color-9">对于 DNS 记录验证的必读文档段落：<a href="/documents/#主机记录格式" target="_blank">文档 - 主机记录格式</a></p>\n</div>\n</div>\n<div class="pd FlexBox mb-3">\n<div class="fs-14" style="').concat(l,'">').concat(Lang("TXT 记录值：",""),'</div>\n<div class="FlexItem">\n<input class="form-control fs-13 q-form" readonly value="').concat(o.authTxtSHA256,'" />\n</div>\n</div>'))):"http-01"==o.type?(c.push(Lang('验证前可 <a href="http://'+i.identifier.value+"/.well-known/acme-challenge/"+FormatText(o.token)+'" target="_blank">打开凭据文件</a> 以测试有效性。',"")+"</div>"),c.push('<div class="pd FlexBox my-3">\n<div class="fs-14" style="'.concat(l,'">').concat(Lang("文件路径：",""),'</div>\n<div class="FlexItem">\n<input class="form-control fs-13 q-form" readonly value="http://').concat(i.identifier.value,"/.well-known/acme-challenge/").concat(FormatText(o.token),'" />\n</div>\n</div>\n<div class="pd FlexBox mb-3">\n<div class="fs-14" style="').concat(l,'">').concat(Lang("文件内容：",""),'</div>\n<div class="FlexItem">\n<input class="form-control fs-13 q-form" readonly value="').concat(o.authTxt,'" />\n</div>\n</div>'))):(c.push(Lang("","")+"</div>"),c.push('<div class="pd FlexBox my-3">\n<div class="fs-14" style="'.concat(l,'">Key Authorizations: </div>\n<div class="FlexItem">\n<input class="form-control fs-13 q-form" readonly value="').concat(o.authTxt,'" />\n</div>\n</div>\n<div class="pd FlexBox mb-3">\n<div class="fs-14" style="').concat(l,'">Digest (SHA-256 Base64): </div>\n<div class="FlexItem">\n<input class="form-control fs-13 q-form" readonly value="').concat(o.authTxtSHA256Base64,'" />\n</div>\n</div>'))),$(".verifyItemBox_"+r).html(c.join("\n"))});for(var n=0;n<a.length;n++){var d=$(".choice_authChall_"+n+"_0");d[0]&&d[0].click()}};!function(){var e,t,a="ACME_HTML_choice_acmeURL",n="ACME_HTML_input_domains",r="ACME_HTML_input_email",s={};window.initMainUI=function(){$(".eccCurveNames").html(X509.SupportECCType2Names().join(Lang("、",", "))),$(".donateBtnIco").html(unescape("%uD83D%uDE18")),$(".versionBox").html(Lang("版本: "+Version,"")),/mobile/i.test(navigator.userAgent)&&($(".main").prepend($(".langBtnBox").css("position",null)),$(".donateWidget").css("position",null)),CLog("initMainUI",0,Lang("OK","OK")),w(),acmeReadDirGotoCORSInit(),downloadFileNameShow(),i(),c(),A()};var i=function(){$("input[name=choice_acmeURL]").bind("click",function(t){var a=t.target,n="manual"==a.value;$(".in_acmeURL").css("opacity",n?1:.4).val(n?e:a.value).attr("readonly",n?null:"");var r=$(a).attr("desckey");$(".descAcmeURL").hide(),r&&$("."+r).show(),e="",f()}),o()},o=function(){e=s.acmeURL||window.Default_ACME_URL||localStorage[a]||"";var t=$("input[name=choice_acmeURL]"),n=0;if(e){for(var r=0,i=0;i<t.length;i++)t[i].value==e&&(n=i+1),"manual"==t[i].value&&(r=i+1);n||(n=r),n--}t[n].click()},c=function(){$(".privateKeyBox").hide(),$("input[name=choice_privateKey]").bind("click",function(e){var t=e.target,a="manual"==t.value;$(".in_privateKey").css("opacity",a?1:.4).val("").attr("readonly",a?null:""),$(".privateKeyBox").show(),v(t.value),g()}),$(".accountKeyBox").hide(),$("input[name=choice_accountKey]").bind("click",function(e){var t=e.target,a="manual"==t.value;$(".in_accountKey").css("opacity",a?1:.4).val("").attr("readonly",a?null:""),$(".accountKeyBox").show(),y(t.value),g()})},l=function(){return"<span>"+Lang("继续"," ")+"</span>"},d=function(){return Lang(" 请稍候... ","")},u=function(){return Lang(" 请重试！","")},p=function(e,t,a,n){var r=new Date,s=("0"+r.getHours()).substr(-2)+":"+("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2);return $(e).html(!1===t?"":'<div style="color:'+(a?1==a?"red":2==a?"#0b1":3==a?"#fa0":a:"")+'">'+(null==n?"["+s+"] ":n)+t+"</div>"),t};window.Toast=function(e,t,a){p(".toastState",e,t,""),$(".toastState").show(),clearTimeout(Toast._int),Toast._int=setTimeout(function(){$(".toastState").hide()},a||5e3)},window.onerror=function(e,t,a,n,r){Toast("【Uncaught Error】"+e+"<pre>at:"+a+":"+n+" url:"+t+"\n"+(r&&r.stack||"-")+"</pre>",1,15e3)};var h=0,m=function(e,t,a){if(e!=h){var n=Lang("被终止","",1);return CLog(t+" "+n,3,"From: "+a+" ["+n+"]"),!0}},f=function(){h++,$(".step1Hide").hide(),$(".step1Show").show(),p(".acmeReadDirState",!1),$(".in_acmeURL").val()&&acmeReadDirClick()};window.acmeReadDirClick=function(){var e,t=++h;$(".step1Hide").hide(),$(".step1Show").show();var n="Step-1",r=".acmeReadDirState",s=$(".in_acmeURL").val().trim();if(!s){p(r,Lang("请填写服务URL！",""),1);return}localStorage[a]=s,s=ACME.URL=s.replace(/\/$/,"");var i=CLog(n,0,p(r,d()+Lang("正在初始化，"," ")+" URL="+ACME.URL,2)),o=function(){m(t,n,i)||(g(),CLog(n,0,p(r,Lang("正常，"," ")+l(),2),ACME.DirData))},c=function(){m(t,n,i)||(i=CLog(n,0,p(r,d()+Lang("正在测试浏览器支持情况，","")+" URL="+ACME.URL,2)),ACME.GetNonce(!0,function(){ACME.TestAccountCORS(function(){CLog(n,0,Lang("此 ACME 服务对浏览器的支持良好。","")),e(!0),o()},f)},function(t,a){a&&e(!1,t),f(t,a)}))},f=function(e,a){!m(t,n,i+" err: "+e)&&(CLog(n,1,p(r,Lang("测试此ACME服务对浏览器的支持情况，发生错误："+e,"")+(a?"":u()),1)),LangReview(r),a&&acmeReadDirGotoCORS())};(function(){ACME.Directory(function(t,a){e=function(e,n){t.corsOK=e?1:-1,t.corsError=n||"",a()},1==t.corsOK?o():-1==t.corsOK?f(t.corsError,!0):c()},function(e,a){m(t,n,i+" err: "+e)||(0===a?(CLog(n,1,p(r,Lang("初始化出错：无法访问此URL。","")+u(),1)),acmeReadDirGotoCORS(Lang("如果你可以在浏览器中直接打开并访问此ACME服务URL，代表此ACME服务对跨域访问支持不良，则请按下面步骤操作：",""))):CLog(n,1,p(r,Lang("初始化出错："+e,"")+u(),1)))})})()};var g=function(){document.getElementById("q-steps1").style.display="none",document.getElementById("q-steps2").style.display="",$(".step2Hide").hide(),$(".step2Show").show(),p(".configStepState",!1),$(".eabShow")[ACME.StepData.needEAB?"show":"hide"](),s.eabKid&&$(".in_eab_kid").val(s.eabKid),s.eabKey&&$(".in_eab_key").val(s.eabKey),$(".termsAgreeBox")[ACME.StepData.termsURL?"show":"hide"](),$(".termsAgreeTips").html(Lang('我同意此证书颁发机构ACME服务的<a href="'+ACME.StepData.termsURL+'" target="_blank">服务条款</a>。',"")),$(".choice_termsAgree").prop("checked",!0);var e=$(".in_domains"),t=localStorage[n],a=s.domains&&s.domains.join(", ")||t;e.val()||e.val(a||""),$(".choice_domains_store").prop("checked",!!t);var e=$(".in_email"),t=localStorage[r],a=s.email||t;e.val()||e.val(a||""),$(".choice_email_store").prop("checked",!!t);var i=function(e){s[e]&&($("input[name=choice_"+e+"][value=manual]")[0].click(),$(".in_"+e).val(s[e]))};i("privateKey"),i("accountKey"),s={}},v=function(e){var t,a=++h,n="Step-2",r=".privateKeyState",s="";if("generateRSA"==e)e="RSA",s=Lang("证书 RSA 私钥 ("+(t=X509.DefaultType2_RSA)+" Bit)"," ");else if("generateECC"==e)e="ECC",t=X509.DefaultType2_ECC,s=Lang("证书 ECC 私钥 ("+(X509.SupportECCType2[t]||t)+")"," ");else{p(r,!1);return}var i=CLog(n,0,p(r,d()+Lang("正在创建","")+s,2));X509.KeyGenerate(e,t,function(e){m(a,n,i)||($(".in_privateKey").val(e),CLog(n,0,p(r,s+Lang("，创建成功。",""),2),"\n"+e))},function(e){m(a,n,i+" err: "+e)||CLog(n,1,p(r,s+Lang("，发生错误："+e,""),1))})},y=function(e){var t,a=++h,n="Step-2",r=".accountKeyState",s="";if("generateRSA"==e)e="RSA",s=Lang("ACME 账户 RSA 私钥 ("+(t=X509.DefaultType2_RSA)+" Bit)"," ");else if("generateECC"==e)e="ECC",t=X509.DefaultType2_ECC,s=Lang("ACME 账户 ECC 私钥 ("+(X509.SupportECCType2[t]||t)+")"," ");else{p(r,!1);return}var i=CLog(n,0,p(r,d()+Lang("正在创建","")+s,2));X509.KeyGenerate(e,t,function(e){m(a,n,i)||($(".in_accountKey").val(e),CLog(n,0,p(r,s+Lang("，创建成功，请复制保管，下次输入自己的账户私钥。",""),2),"\n"+e))},function(e){m(a,n,i+" err: "+e)||CLog(n,1,p(r,s+Lang("，发生错误："+e,""),1))})};window.configStepClick=function(){var e=++h,t="Step-2",a=".configStepState";$(".step2Hide").hide(),$(".step2Show").show(),p(a,!1);var s=$(".in_domains").val().trim(),i=$(".choice_domains_store").prop("checked"),o=$(".in_privateKey").val().trim(),c=$(".in_accountKey").val().trim(),u=$(".in_email").val().trim(),f=$(".choice_email_store").prop("checked"),g=$(".in_eab_kid").val().trim(),v=$(".in_eab_key").val().trim(),y=$(".choice_termsAgree").prop("checked");s=s.replace(/\s+/g,",").replace(/，+/g,",").split(/,+/);for(var S=0,A={};S<s.length;S++){var x=s[S];if(x){if(A[x])return p(a,Lang("域名"+x+"重复！",""),1)}else{s.splice(S,1),S--;continue}if(/[:\/;]/.test(x))return p(a,Lang("域名"+x+"格式错误！",""),1);A[x]=1}if(localStorage[n]=i?s.join(", "):"",localStorage[r]=f?u:"",!s.length)return p(a,Lang("域名是必须项。"," "),1);if(!c)return p(a,Lang("需要创建或输入 ACME 账户的私钥。"," "),1);if(!o)return p(a,Lang("需要证书的私钥。"," "),1);if(!/.+@.+\..+/.test(u)||/[\s,;]/.test(u))return p(a,Lang("需要填写电子邮箱地址。"," "),1);if(ACME.StepData.needEAB&&!(g&&v))return p(a,Lang("EAB KID and HMAC KEY not found."," "),1);if(ACME.StepData.termsURL&&!y)return p(a,Lang("需要同意使用条款。"," "),1);var E,w,L=function(){X509.KeyParse(o,function(e){E=e,N()},function(e){p(a,Lang("证书私钥无效",""),1)},1)},N=function(){X509.KeyParse(c,function(e){w=e,M()},function(e){p(a,Lang("账户私钥无效，无法工作，请前往<a href='/settings/'>设置</a>页面清空数据",""),1)},1)},b=CLog(t,0,p(a,d(),2)),M=function(){m(e,t,b)||(ACME.StepData.config={domains:s,privateKey:E,accountKey:w,email:u,eabKid:g,eabKey:v},CLog(t,0,"config",ACME.StepData.config),B())},B=function(){var n=CLog(t,0,p(a,d()+Lang("调用 ACME 服务 newAccount 接口："," ")+ACME.DirData.newAccount,2));ACME.StepAccount(function(){m(e,t,n)||j()},function(r){m(e,t,n+" err: "+r)||CLog(t,1,p(a,Lang("调用 ACME 服务的 newAccount 接口："," ")+ACME.DirData.newAccount+Lang("，发生错误："+r,""),1))})},j=function(){var n,r=function(r){e==h&&(n=CLog(t,0,p(a,d()+Lang("调用 ACME 服务订单接口。"," ")+" "+r+" URL:"+ACME.DirData.newOrder,2)))};r(""),ACME.StepOrder(r,function(){m(e,t,n)||_()},function(r){m(e,t,n+" err: "+r)||CLog(t,1,p(a,Lang("调用 ACME 服务订单接口：","")+ACME.DirData.newOrder+Lang("，发生错误："+r,""),1))})},_=function(){C(),CLog(t,0,p(a,Lang("配置完成，","")+l(),2),ACME.StepData)};L()};var C=function(){document.getElementById("q-steps2").style.display="none",document.getElementById("q-steps3").style.display="",$(".step3Hide").hide(),$(".step3Show").show(),$(".verifyStepBtn").show(),$(".verifyRunStopBtn").hide(),$(".finalizeOrderBtn").hide(),p(".verifyStepState",!1),verifyBoxShow()};window.verifyRunStopClick=function(){++h,$(".verifyStepBtn").show(),$(".verifyRunStopBtn").hide(),$(".finalizeOrderBtn").hide(),p(".verifyStepState",!1),t&&t()},window.verifyStepClick=function(){var e=++h,a="Step-3",n=".verifyStepState";$(".step3Hide").hide(),$(".step3Show").show(),$(".verifyStepBtn").hide(),$(".verifyRunStopBtn").show(),$(".finalizeOrderBtn").hide(),p(n,!1);var r=ACME.StepData.config.domains,s=ACME.StepData.auths,i=function(t,i,o){for(var c=i||e!=h,l=0,d=0,u=0,m=0;m<r.length;m++){var f=s[r[m]],g=f.challenges,v=$(".verifyItemState_"+m);if(11==f.authState){p(v,ACME.ChallName(g[f.challIdx])+" OK!",2,""),l++;continue}if(t){for(var y=$("input[name=choice_authItem_"+m+"]"),C=0;C<y.length;C++){var S=y[C];S.checked?f.challIdx=+$(S).attr("challidx"):$(S.parentNode).hide()}f.authState=0,f.authTryCount=0,f.authError="",f.authTimer=0}var A=ACME.ChallName(g[f.challIdx]);if(12==f.authState){p(v,A+Lang("，验证失败：","")+f.authError,1,""),d++;continue}u++,c?(p(v,!1),clearTimeout(f.authTimer),f.authTimer=0):2==f.authState?p(v,Lang("等待验证 ... ","")+" "+f.authTryCount+" "+f.authError,3,""):1==f.authState?p(v,Lang("验证中 ... ",""),0,""):p(v,Lang("等待验证 ... ",""),0,"")}if(!c||i){var x=Lang("请重试"," "),E=p(n,(o?Lang("验证失败，","")+x:c?Lang("已取消，","Canceled, ")+x:Lang("正在验证，请耐心等待 ... ",""))+"<div>"+Lang("验证通过：","")+l+", "+Lang("未通过：","")+d+", "+Lang("验证中：","")+u+"</div>",c?1:0);c&&CLog(a,1,E)}};i(1);var o=function(){if(e==h){i();for(var t,a=0,n=0,c=0,l=0;l<r.length;l++){var d=s[r[l]];t||d.authState||(t=d),1==d.authState&&a++,11==d.authState&&n++,12==d.authState&&c++}return n==r.length?g():n+c==r.length?f():void(t&&!a&&(t.authState=1,t.authTryCount++,t.authError="",i(),ACME.StepVerifyAuthItem(t,t.challIdx,function(a,n,r){e==h&&(a?t.authState=11:(t.authState=2,t.authError=r,t.authTimer=setTimeout(function(){t.authState=0,t.authTimer=0,o()},n)),o())},function(a){e==h&&(t.authState=12,t.authError=a,o())})))}};CLog(a,0,"==========Verify Start==========");var c=function(){$(".verifyRunStopBtn").hide(),t=null,CLog(a,0,"==========Verify End==========")};t=function(){c(),i(0,1)};var f=function(){CLog(a,1,"Verify Fail!"),i(0,1,1),c()},g=function(){_components_main__WEBPACK_IMPORTED_MODULE_0__.c0.tc("验证成功，正在颁发 ..."),CLog(a,0,"Verify OK!"),c(),finalizeOrderClick()};window.finalizeOrderClick=function(){$(".finalizeOrderBtn").hide();var t,r=function(r){e==h&&(t=CLog(a,0,p(n,d()+Lang("验证已通过，正在签发证书。","")+" "+r,2)))};r(""),ACME.StepFinalizeOrder(r,function(){m(e,a,t)||(S(),CLog(a,0,p(n,Lang("验证已通过，证书已签发，","")+l(),2),ACME.StepData))},function(r){m(e,a,t+" err: "+r)||($(".finalizeOrderBtn").show(),CLog(a,1,p(n,Lang("签发证书发生错误，","")+u()+Lang("如果多次重试都无法签发证书，请直接刷新页面重新开始。","")+" Error: "+r,1)))})},o()};var S=function(){document.getElementById("q-steps2").style.display="none",document.getElementById("q-steps3").style.display="none",document.getElementById("q-steps4").style.display="",$(".step4Hide").hide(),$(".step4Show").show(),p(".downloadStepState",!1);var e=ACME.StepData.config,t=ACME.StepData.order.downloadPEM,a=t||Lang("未发现证书，请刷新页面重新开始。","",!0);let n=new Date().toISOString(),r={cert:a,key:e.privateKey.pem,time:n,domains:e.domains},s=JSON.parse(localStorage.getItem("q-manageDataPairs"))||[];s.push(r),localStorage.setItem("q-manageDataPairs",JSON.stringify(s)),$(".txt_downloadCert").val(a),$(".txt_downloadKey").val(e.privateKey.pem),downloadFileNameShow(x=e.domains[0].replace(/^\*\./g,"").replace(/[^\w]/g,"_"));var i=[],o=function(e){return i.push("\n=========== "+e+" ==========="),i},c=Object.assign({acmeURL:ACME.URL,accountURL:ACME.StepData.account.url,X509:{DefaultType2_RSA:X509.DefaultType2_RSA,DefaultType2_ECC:X509.DefaultType2_ECC},Window:{DefaultDownloadFileNames:DefaultDownloadFileNames}},e);c.privateKey=e.privateKey.pem,c.accountKey=e.accountKey.pem;var l="/********** "+Lang($(".clientNameCN").html(),$(".clientNameEN").html(),!0)+" *********/";i.push(l),i.push(Lang("在线网址（GitHub）：","",!0)+"https://xiangyuecn.github.io/ACME-HTML-Web-Browser-Client/ACME-HTML-Web-Browser-Client.html"),i.push(Lang("在线网址（Gitee）：","",!0)+"https://xiangyuecn.gitee.io/acme-html-web-browser-client/ACME-HTML-Web-Browser-Client.html"),i.push(""),i.push("GitHub: https://github.com/xiangyuecn/ACME-HTML-Web-Browser-Client"),i.push("Gitee: https://gitee.com/xiangyuecn/ACME-HTML-Web-Browser-Client"),i.push(""),i.push(Lang("提示：你可以将本文件拖拽进客户端网页内，将自动填充本次证书申请的所有配置参数。","",!0)),i.push(""),o(Lang("证书申请时间","",!0)).push(new Date().toLocaleString()),o(Lang("域名列表","",!0)).push(e.domains.join(", ")),o(Lang("ACME服务地址","",!0)).push(ACME.URL),o(Lang("CSR文本","",!0)).push(ACME.StepData.order.orderCSR),o(Lang("证书PEM文本","",!0)).push(a),o(Lang("证书私钥PEM文本","",!0)).push(e.privateKey.pem),o(Lang("账户私钥PEM文本","",!0)).push(e.accountKey.pem),o(Lang("账户URL","",!0)).push(ACME.StepData.account.url),o(Lang("完整配置信息","",!0)).push("<ACME-HTML-Web-Browser-Client>"+JSON.stringify(c)+"</ACME-HTML-Web-Browser-Client>"),i.push(""),i.push(l),i.push(""),$(".txt_downloadLog").val(t?i.join("\n"):a)},A=function(){$("body").bind("dragover",function(e){e.preventDefault()}).bind("drop",function(e){e.preventDefault();var t=e.dataTransfer.files[0];if(t){var a=new FileReader;a.onload=function(e){var t=a.result,n=/ACME-HTML-Web-Browser-Client>(.+?)<\/ACME-HTML-Web-Browser-Client/.exec(t);if(!n)return Toast(Lang("拖入的文件中未发现配置信息，请拖上次申请证书时保存的记录LOG文件！",""),1);for(var r in(s=JSON.parse(n[1])).X509)X509[r]=s.X509[r];for(var r in s.Window)window[r]=s.Window[r];CLog("DropConfigFile",0,"Reset Config",s),Toast(Lang("识别到拖入的记录LOG文件，已填充上次申请证书时使用的配置。",""),2),o(),downloadFileNameShow()},a.readAsText(t)}})},x="";window.DefaultDownloadFileNames={Cert:"",Key:"",Log:""},window.downloadBtnClick=function(e){var t=$(".txt_download"+e).val(),a=x;"Cert"==e&&(a+=".pem"),"Key"==e&&(a+=".key"),"Log"==e&&(a+=".log"),a=DefaultDownloadFileNames[e]||a;var n=URL.createObjectURL(new Blob([t],{type:"text/plain"})),r=document.createElement("A");r.href=n,r.download="ZSEncrypt_"+a,r.click()},window.downloadFileNameShow=function(e){e=e||"your_domain";var t=(DefaultDownloadFileNames.Cert||"").replace(/\.[^\.]+$/g,"");$(".downloadFileName").html(t||e),$(".downloadKeyFileName").html(DefaultDownloadFileNames.Key||e+".key"),$(".downloadCertFileName").html(DefaultDownloadFileNames.Cert||e+".pem")},window.Test_AllStepData_Save=function(){if(!ACME.StepData.order)throw Error(Lang("未完成第二步操作","",!0));var e=ACME.StepData.config;delete ACME.PrevNonce,e.privateKey=e.privateKey.pem,e.accountKey=e.accountKey.pem,localStorage[E]=JSON.stringify(ACME),ACME=null,console.warn(Lang("仅供测试：已保存测试数据，需刷新页面","",!0))};var E="ACME_HTML_Test_AllStepData",w=function(){localStorage[E]&&console.warn(Lang("仅供测试：已保存测试数据，调用Test_Restore_StepXXX()进行恢复步骤界面","",!0))},L=function(e){var t=JSON.parse(localStorage[E]||"{}");if(!t.StepData)throw Error(Lang("未保存数据","",!0));for(var a in t)ACME[a]=t[a];var n=ACME.StepData.config;X509.KeyParse(n.privateKey,function(t){n.privateKey=t,X509.KeyParse(n.accountKey,function(t){n.accountKey=t,console.log("ACME.StepData",ACME.StepData),setTimeout(function(){e()})})})};window.Test_Restore_StepAuth=function(){L(function(){console.warn(Lang("仅供测试：已手动恢复步骤三界面","",!0)),C()})},window.Test_Restore_StepDownload=function(){L(function(){console.warn(Lang("仅供测试：已手动恢复步骤四界面","",!0)),S()})}}(),function(){window.ACME={URL:"",SyncID:0,DirData:{},Directory:function(e,t){var n=++ACME.SyncID,r=ACME.URL,s="ACME_HTML_cache_"+r,i=function(a){var r=a.data;if(n!=ACME.SyncID)return t("cancel");var i=r.meta||{};if(!r.newOrder)return t("Not newOrder found: "+FormatText(JSON.stringify(r)));ACME.DirData=r,ACME.StepData.termsURL=i.termsOfService,ACME.StepData.needEAB=!!i.externalAccountRequired;var o=function(){localStorage[s]=JSON.stringify(a)};o(),e(a,o)},o=JSON.parse(localStorage[s]||"{}");if(o.time&&Date.now()-o.time<864e5)return i(o);a(r,null,function(e){i({data:e,time:Date.now()})},t)},StepData:{},ChallName:function(e){return"dns-01"==e.type?Lang("DNS 记录验证"," "):"http-01"==e.type?Lang("文件验证"," "):e.type.toUpperCase()},ChallSort:function(e){return"dns-01"==e.type?"1_"+e.type:"http-01"==e.type?"2_"+e.type:"3_"+e.type},GetJwsA:async function(e,t){var a=ACME.StepData.config.accountKey,n="ES256",r={name:"ECDSA",hash:"SHA-256"};"RSA"==a.type&&(n="RS256",r={name:"RSASSA-PKCS1-v1_5"}),e.alg=n;var s={protected:Json2UrlB64(e),payload:t?Json2UrlB64(t):""},i=Str2Bytes(s.protected+"."+s.payload),o=await crypto.subtle.sign(r,a.key,i);return s.signature=Bytes2UrlB64(o),s},GetNonceA:function(e){return new Promise(function(t,a){ACME.GetNonce(e,function(e){t(e)},function(e){a(Error(e))})})},GetNonce:function(e,t,n){var r=ACME.PrevNonce;if(ACME.PrevNonce="",!e&&r)return t(r);a({url:ACME.DirData.newNonce,method:"HEAD",response:!1},null,function(e,a){ACME.PrevNonce="";var r=a.getResponseHeader("Replay-Nonce");if(!r){n("GetNonce: "+Lang("此ACME服务对浏览器访问支持太差，无法跨域获取Replay-Nonce响应头。","This ACME service has too poor browser access support to get the Replay-Nonce response header across domains."),!0);return}t(r)},function(e){n("GetNonce: "+e)})},TestAccountCORS:function(e,t){a({url:ACME.DirData.newAccount,method:"POST",response:!1,nocheck:!0},{},function(a,n){n.status>0?e():t("["+n.status+"]",!0)},function(e){t(e)})},StepAccount:async function(e,t){var a=++ACME.SyncID,n="ACME.StepAccount";CLog(n,0,"==========Account Start==========");var r="";try{await ACME._StepAccountA(a,n)}catch(e){CLog(n,1,r=e.message||"-",e)}CLog(n,0,"==========Account End=========="),r?t(r):e()},_StepAccountA:async function(a,n){var r=ACME.DirData.newAccount,s=ACME.StepData.config,i={contact:["mailto:"+s.email],termsOfServiceAgreed:!0};if(ACME.StepData.needEAB){var o={protected:Json2UrlB64({alg:"HS256",kid:s.eabKid,url:r}),payload:Json2UrlB64(X509.PublicKeyJwk(s.accountKey))},c=await crypto.subtle.importKey("raw",UrlB642Bytes(s.eabKey),{name:"HMAC",hash:"SHA-256"},!0,["sign"]),l=Str2Bytes(o.protected+"."+o.payload),d=await crypto.subtle.sign("HMAC",c,l);o.signature=Bytes2UrlB64(d),i.externalAccountBinding=o,CLog(n,0,"externalAccountBinding",o)}var u=await ACME.GetJwsA({jwk:X509.PublicKeyJwk(s.accountKey),nonce:await ACME.GetNonceA(!0),url:r},i),p=await t(r,u);if(a!=ACME.SyncID)throw Error("cancel");ACME.StepData.account={url:e(p.xhr,"Location"),data:p.data},CLog(n,0,"Account OK",ACME.StepData.account)},StepOrder:async function(e,t,a){var n=++ACME.SyncID,r="ACME.StepOrder";CLog(r,0,"==========Order Start==========");var s="";try{await ACME._StepOrderA(e,n,r)}catch(e){CLog(r,1,s=e.message||"-",e)}CLog(r,0,"==========Order End=========="),s?a(s):t()},_StepOrderA:async function(a,n,r){for(var s=ACME.DirData.newOrder,i=ACME.StepData.config,o=[],c=0;c<i.domains.length;c++)o.push({type:"dns",value:i.domains[c]});var l={identifiers:o};a("newOrder...");var d=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:s},l),u=await t(s,d);if(n!=ACME.SyncID)throw Error("cancel");u.data.orderUrl=e(u.xhr,"Location"),ACME.StepData.order=u.data,CLog(r,0,"Order OK",ACME.StepData.order);var p=JSON.stringify(X509.PublicKeyJwk(i.accountKey)),h=await crypto.subtle.digest({name:"SHA-256"},Str2Bytes(p));h=Bytes2UrlB64(h);for(var m=ACME.StepData.order.identifiers,f=0,g=ACME.StepData.order.authorizations,c=0;c<m.length;c++)-1==i.domains.indexOf(m[c].value)&&(f=1);if(f||m.length!=g.length||m.length!=i.domains.length)throw Error(Lang("创建的订单中的域名和配置的不一致","The domain name in the created order is inconsistent with the configuration"));if(n!=ACME.SyncID)throw Error("cancel");ACME.StepData.auths={};for(var c=0;c<g.length;c++){a("auth("+(c+1)+"/"+g.length+")...");var s=g[c],d=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:s},""),u=await t(s,d);if(n!=ACME.SyncID)throw Error("cancel");u.data.domain=m[c].value,u.data.authUrl=s,ACME.StepData.auths[m[c].value]=u.data;for(var v=u.data.challenges,y=0;y<v.length;y++){var C=v[y];C.authTxt=C.token+"."+h;var S=await crypto.subtle.digest({name:"SHA-256"},Str2Bytes(C.authTxt));if(n!=ACME.SyncID)throw Error("cancel");C.authTxtSHA256=Bytes2UrlB64(S),C.authTxtSHA256Base64=Bytes2Base64(S)}}CLog(r,0,"Order Authorizations",ACME.StepData.auths)},StepVerifyAuthItem:async function(e,t,a,n){var r="ACME.verify["+e.challenges[t].type+"]:"+e.domain,s="";try{await ACME._StepVerifyAuthItemA(e,t,ACME.SyncID,r,a,n)}catch(e){CLog(r,1,s=e.message||"-",e)}s&&a(!1,1e3,s)},_StepVerifyAuthItemA:async function(e,a,n,r,s,i){var o=e.challenges[a];if(!o.isSend){var c=o.url,l=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:c},{}),d=await t({url:c,nocheck:!0},l),u=d.xhr.status;u>=200&&u<300&&(o.isSend=!0)}var c=e.authUrl,l=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:c},""),d=await t(c,l),p=d.data;return"pending"==p.status?(CLog(r,0,"pending..."),s(!1,1e3,"pending...")):"valid"==p.status?(CLog(r,0,"valid OK"),s(!0)):(CLog(r,1,"Fail",p),i(p.status+": "+FormatText(JSON.stringify(p))))},StepFinalizeOrder:async function(e,t,a){var n=++ACME.SyncID,r="ACME.StepFinalizeOrder";CLog(r,0,"==========Finalize Start==========");var s="";try{await ACME._StepFinalizeOrderA(e,n,r)}catch(e){CLog(r,1,s=e.message||"-",e)}CLog(r,0,"==========Finalize End=========="),s?a(s):t()},_StepFinalizeOrderA:async function(e,a,n){var r=ACME.StepData.order,s=ACME.StepData.config,i=s.domains;if(!r.finalizeIsSend){e("finalize...");var o=await new Promise(function(e,t){X509.CreateCSR(s.privateKey,i[0],i,function(t){e(t)},function(e){t(Error(e))})});r.orderCSR=o,CLog(n,0,"CSR\n"+o),o=Bytes2UrlB64(ASN1.PEM2Bytes(o));var c=r.finalize,l=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:c},{csr:o}),d=await t(c,l);if(a!=ACME.SyncID)throw Error("cancel");CLog(n,0,"finalize result",d.data),r.finalizeIsSend=!0}for(var u=Date.now(),p=0;!r.checkOK&&Date.now()-u<6e4;){if(a!=ACME.SyncID)throw Error("cancel");e("check retry:"+ ++p+"...");var c=r.orderUrl,l=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:c},""),d=await t(c,l);if(a!=ACME.SyncID)throw Error("cancel");var h=d.data;if("valid"==h.status){r.checkOK=!0,r.certUrl=h.certificate,CLog(n,0,"check OK",h);break}if("invalid"==h.status)throw CLog(n,1,"check Fail",h),Error(h.status+": "+FormatText(JSON.stringify(h)));CLog(n,0,h.status+"... wait 1s",h),await new Promise(function(e){setTimeout(e,1e3)})}if(!r.downloadPEM){e("download...");var c=r.certUrl,l=await ACME.GetJwsA({kid:ACME.StepData.account.url,nonce:await ACME.GetNonceA(),url:c},""),d=await t({url:c,response:!1},l);if(a!=ACME.SyncID)throw Error("cancel");var m=d.xhr.responseText;r.downloadPEM=m,CLog(n,0,"download OK\n"+m)}}};var e=function(e,t){var a=e.getResponseHeader(t);if(!a)throw acmeReadDirGotoCORS(),Error(Lang("无法读取响应头"+t+"，可能是因为此ACME服务对跨域访问支持不良，请按第一步显示的提示操作。","The response header "+t+" cannot be read, This may be because this ACME service does not support cross domain access, Please follow the prompt displayed in step 1."));return a},t=function(e,t){return new Promise(function(n,r){a(e,t,function(e,t){n({data:e,xhr:t})},function(e){r(Error(e))})})},a=function(e,t,a,n){var r="string"==typeof e?{url:e}:e;e=r.url;var s=r.method||(t?"POST":"GET"),i="ACME.Request";CLog(i,4,"send "+s,r,t);var o=new XMLHttpRequest;o.timeout=3e4,o.open(s,e,!0),o.onreadystatechange=function(){if(4==o.readyState){ACME.PrevNonce=o.getResponseHeader("Replay-Nonce")||"";var e,t,s=o.status<200||o.status>=300,c=null==r.response||r.response;if(c||s){t=o.responseText;try{t=e=JSON.parse(t)}catch(e){}}if(CLog(i,4,"send End",r,{status:o.status,headers:o.getAllResponseHeaders()},t),r.nocheck||!s&&(!c||e))return a(e,o);n((s?"["+o.status+"]":"")+FormatText(o.responseText),o.status)}},t?("object"==typeof t&&(t=JSON.stringify(t)),o.setRequestHeader("Content-Type",r.contentType||"application/jose+json"),o.send(t)):o.send()}}(),function(){for(var e in window.X509={DefaultType2_RSA:"2048",DefaultType2_ECC:"P-256",SupportECCType2:{"P-256":"prime256v1","P-384":"secp384r1","P-521":"secp521r1"},SupportECCType2Names:function(){var e=[];for(var t in X509.SupportECCType2)e.push(X509.SupportECCType2[t]);return e},KeyGenerate:function(e,t,a,n){var r=0;if("RSA"==e)r={publicExponent:new Uint8Array([1,0,1]),name:"RSASSA-PKCS1-v1_5",modulusLength:+t,hash:"SHA-256"};else if("ECC"==e)r={name:"ECDSA",namedCurve:t};else{n("Not support "+e);return}crypto.subtle.generateKey(r,!0,["sign","verify"]).then(function(e){crypto.subtle.exportKey("jwk",e.privateKey).then(function(e){a(X509.KeyExport(e))}).catch(function(e){n(Lang("此浏览器不支持导出"+r.name+"+PKCS#8格式密钥：","This browser does not support exporting "+r.name+"+PKCS#8 format keys: ")+e.message)})}).catch(function(e){n(Lang("此浏览器不支持生成"+r.name+"：","This browser does not support generating "+r.name+": ")+e.message)})},KeyParse:function(e,t,a,n){var r,s,i={},o=function(e){i.error=e,a(e,i)};if(!/BEGIN\s*(RSA|EC)?\s*(PUBLIC|PRIVATE)\s*KEY/.test(e))return o(Lang("不是RSA或ECC密钥","Not an RSA or ECC key"));i.type="EC"==RegExp.$1?"ECC":RegExp.$1;var c=!!RegExp.$1,l="PUBLIC"==RegExp.$2;if(l&&n)return o(Lang("不是私钥","Is not a private key"));try{var d=null,u=ASN1.ParsePEM(e);if(i.asn1=u,c){if("RSA"==i.type)d=u;else if("ECC"==i.type){if(l)return o(Lang("不支持ECC PKCS#1格式公钥","ECC PKCS#1 format public key is not supported"));var p=u.sub[2].sub[0].oid;i.type2=ASN1.OID[p]||"",d=u}}else{var h=l?0:1,m=u.sub[h].sub[0].oid,p=u.sub[h].sub[1].oid;i.type=ASN1.OID[m]||"",i.type2=ASN1.OID[p]||"",d="ECC"==i.type&&l?u:new ASN1().parse(u.sub[h+1].bytes)}i.paramAsn1=d}catch(e){return o(Lang("密钥解析失败：","Key resolution failed: ")+e.message)}if("RSA"==i.type){var h=l?0:1;i.param={n:d.sub[h].bytes,e:d.sub[h+1].bytes,d:l?null:d.sub[h+2].bytes};for(var f="p,q,dp,dq,qi".split(","),g=0;g<5;g++)i.param[f[g]]=l?null:d.sub[h+3+g].bytes;i.type2=8*i.param.n.length+""}else{if("ECC"!=i.type)return o(Lang("不支持的密钥类型：","Unsupported key type: ")+m);if(!X509.SupportECCType2[i.type2])return o(Lang("只支持"+X509.SupportECCType2Names().join("、")+"曲线的ECC密钥","ECC key only supported for "+X509.SupportECCType2Names().join(",")+" curve"));if(l)var v=d.sub[1].bytes;else var h=c?3:2,v=d.sub[h].sub[0].bytes;if(4!=v[0])return o("ECC !0x04: "+v[0]);var y=(v.length-1)/2;i.param={x:v.slice(1,1+y),y:v.slice(1+y),d:l?null:d.sub[1].bytes}}for(var C in i.isPKCS1=c,i.hasPrivate=!l,i.pem=e,"RSA"==i.type?(r={publicExponent:new Uint8Array(i.param.n.buffer),name:"RSASSA-PKCS1-v1_5",modulusLength:+i.type2,hash:"SHA-256"},s={kty:"RSA",alg:"RS256"}):"ECC"==i.type&&(r={name:"ECDSA",namedCurve:i.type2},s={kty:"EC",crv:i.type2}),s=Object.assign(s,{ext:!0,key_ops:[l?"verify":"sign"]}),i.param)i.param[C]&&(s[C]=Bytes2UrlB64(i.param[C]));crypto.subtle.importKey("jwk",s,r,!0,[l?"verify":"sign"]).then(function(e){i.key=e,t(i)}).catch(function(e){o(Lang("密钥转成CryptoKey失败：","Failed to convert key to CryptoKey: ")+e.message)})},PublicKeyJwk:function(e){var t=e.param;if("RSA"==e.type)return{e:Bytes2UrlB64(t.e),kty:"RSA",n:Bytes2UrlB64(t.n)};if("ECC"==e.type)return{crv:e.type2,kty:"EC",x:Bytes2UrlB64(t.x),y:Bytes2UrlB64(t.y)};throw Error("Jwk: "+e.type)},KeyExport:function(e,t,a){var n,r="KeyExport: ",s=ASN1.S,i=ASN1.V,o=e.param,c=o&&e.type,l=e.type2;if(!o){if(e.kty)"ECC"==(c="EC"==e.kty?"ECC":e.kty)&&(l=e.crv);else throw Error(r+"bad key")}var d=("ECC"==c?"x,y,d":"n,e,d,p,q,dp,dq,qi").split(",");if(!o){o={};for(var u=0;u<d.length;u++){var p=d[u],h=e[p];h&&(o[p]=UrlB642Bytes(h))}}var m=!t&&o.d;if("RSA"==c){var f=s(48,i(2,o.n),i(2,o.e));if(m){f.sub.splice(0,0,i(2,[0]));for(var u=2;u<d.length;u++)f.push(i(2,o[d[u]]))}n=f.toBytes()}else if("ECC"==c){var g=new Uint8Array(1+2*o.x.length);g[0]=4,g.set(o.x,1),g.set(o.y,1+o.x.length),n=m?s(48,i(2,[1]),i(4,o.d),s(161,i(3,g))).toBytes():g}else throw Error(r+c);var v=s(48,i(6,ASN1.OID2Bytes(ASN1.OID[c])),"RSA"==c?i(5,[]):i(6,ASN1.OID2Bytes(ASN1.OID[l])));if(m)var y=s(48,i(2,[0]),v,i(4,n));else var y=s(48,v,i(3,n));if(2==a)return y;if(n=y.toBytes(),1==a)return n;var C=Bytes2Base64(n).replace(/(.{64})/g,"$1\n").trim(),S=m?"PRIVATE":"PUBLIC";return"-----BEGIN "+S+" KEY-----\n"+C+"\n-----END "+S+" KEY-----"},CreateCSR:function(e,t,a,n,r){var s=ASN1.S,i=ASN1.V;try{var o=X509.KeyExport(e,!0,2)}catch(e){return r(e.message)}for(var c=s(48),l=0;l<a.length;l++)c.push(i(130,Str2Bytes(a[l])));var d=s(48,i(2,[0]),s(48,s(49,s(48,i(6,ASN1.OID2Bytes("2.5.4.3")),i(12,Str2Bytes(t))))),o,s(160,s(48,i(6,ASN1.OID2Bytes("1.2.840.113549.1.9.14")),s(49,s(48,s(48,i(6,ASN1.OID2Bytes("2.5.29.17")),i(4,c.toBytes()))))))),u=d.toBytes(),p={name:"ECDSA",hash:"SHA-256"};"RSA"==e.type&&(p={name:"RSASSA-PKCS1-v1_5"}),crypto.subtle.sign(p,e.key,u).then(function(t){var a=new Uint8Array(t);if("ECC"==e.type){var r=a.subarray(0,e.param.x.length),o=a.subarray(e.param.x.length);a=s(48,i(2,r),i(2,o)).toBytes()}n("-----BEGIN CERTIFICATE REQUEST-----\n"+Bytes2Base64(s(48,d,s(48,i(6,ASN1.OID2Bytes(ASN1.OID["SHA256_"+e.type])),"RSA"==e.type?i(5,[]):null),i(3,a)).toBytes()).replace(/(.{64})/g,"$1\n").trim()+"\n-----END CERTIFICATE REQUEST-----")}).catch(function(e){r("CSR sign:"+e.message)})}},window.ASN1=function(e,t){this.sub=[],e&&this.setTag(e),t&&this.setBytes(t)},ASN1.S=function(e){for(var t=new ASN1(e),a=1,n=arguments;a<n.length;a++)n[a]&&t.push(n[a]);return t},ASN1.V=function(e,t){return new ASN1(e,t)},ASN1.ParsePEM=function(e){return new ASN1().parsePEM(e)},ASN1.TagNames={"01":"BOOLEAN","02":"INTEGER","03":"BIT_STRING","04":"OCTET_STRING","05":"NULL","06":"OID","0C":"UTF8String",13:"Printable_String",17:"UTCTime",18:"GeneralizedTime",30:"SEQUENCE",31:"SET"},ASN1.OID={"1.2.840.113549.1.1.1":"RSA","1.2.840.113549.1.1.11":"SHA256_RSA","1.2.840.10045.2.1":"ECC","1.2.840.10045.4.3.2":"SHA256_ECC","1.2.840.10045.3.1.7":"P-256","1.3.132.0.34":"P-384","1.3.132.0.35":"P-521"},ASN1.OID)ASN1.OID[ASN1.OID[e]]=e;ASN1.OID2Bytes=function(e){var t=e.split("."),a=[],n=+t[0],r=+t[1];if(!/^[\d\.]+$/.test(e)||t.length<3||n>2||40*n+r>255)throw Error("bad oid: "+e);a.push(40*n+r);for(var s=2,i=t.length;s<i;s++){for(var o=+t[s],c=[];o>=128;)c.push(o%128),o/=128;c.push(o),c.reverse();for(var l=0,d=c.length-1;l<=d;l++)l!=d?a.push(128+c[l]):a.push(c[l])}return new Uint8Array(a)},ASN1.OID2Text=function(e){var t="",a=e[0],n=a<80?a<40?0:1:2;t+=n+"."+(a-40*n);for(var r=1,s=e.length;r<s;){for(var i=0;r<s;){var o=e[r++];if(i*=128,o>=128)i+=o-128;else{i+=o;break}}t+="."+i}return t},ASN1.ParseSize=function(e,t){var a=t[e[0]++],n=0;if(a<128)n=a;else if(128==a)n=-404;else for(var r=0,s=127&a;r<s;r++)n=256*n+t[e[0]++];if(n<0||n>t.length-e[0])throw Error("ASN.1 Bad size "+n);return n},ASN1.ParseBlock=function(e,t,a){for(a=a||[];e[0]<t.length;){var n=e[0],r=new ASN1,s=t[e[0]++],i=ASN1.ParseSize(e,t);if((32&s)!=0)r.parse(t.slice(n,e[0]+i));else{var o=t.slice(e[0],e[0]+i);(2==s||3==s)&&o.length>1&&0==o[0]&&(o=o.slice(1)),r.setTag(s),r.setBytes(o)}a.push(r),e[0]+=i}return a},ASN1.PEM2Bytes=function(e){e=e.replace(/[\s\r\n]/g,"");var t=/^-+BEGIN\w*-+([^-]+)-+END\w+-+$/i.exec(e);try{return Base642Bytes(t[1])}catch(e){throw Error(Lang("不是pem格式。","Not a pem format."))}},ASN1.prototype={setTag:function(e){var t=(e<16?"0":"")+e.toString(16).toUpperCase();this.tag=e,this.tagTxt=t,this.tagName=ASN1.TagNames[t]||"0x"+t},setBytes:function(e){if(null==e.length||null==e.slice&&null==e.subarray)throw Error("Not Array");6==this.tag&&(this.oid=ASN1.OID2Text(e)),(12==this.tag||19==this.tag)&&(this.string=Bytes2Str(e)),this.bytes=e},push:function(e){if(!e.parsePEM)throw Error("Not ASN1");return this.sub.push(e),this},parsePEM:function(e){return this.parse(ASN1.PEM2Bytes(e))},parse:function(e){var t=[0];if((32&e[0])==0)throw Error("ASN.1 parse: Not SEQ");this.setTag(e[t[0]++]);var a=ASN1.ParseSize(t,e);return e=e.slice(t[0],t[0]+a),this.setBytes(e),ASN1.ParseBlock([0],e,this.sub),this},toBytes:function(e){var t=[],a=0;if(this.sub.length)for(var n=0;n<this.sub.length;n++){var r=this.sub[n].toBytes();t.push(r),a+=r.length}else this.bytes&&this.bytes.length&&((2==this.tag&&this.bytes[0]>=128||3==this.tag)&&(t.push([0]),a++),t.push(this.bytes),a+=this.bytes.length);if(!e){var r=[],s=a;if(s<128)r.push(s);else{for(;s>255;)r.push(255&s),s>>=8;r.push(255&s),r.push(128+r.length)}r.push(this.tag),r.reverse(),t.splice(0,0,r),a+=r.length}for(var i=new Uint8Array(a),o=0,n=0;n<t.length;n++){var r=t[n];i.set(r,o),o+=r.length}return i}}}(),function(){window.LangCur="cn",window.Lang=function(e,t,a){let n=e,r=" "+t;if(a)return"cn"==LangCur?n:r;var s="",i={cn:n,en:r};for(var o in i)s+=(LangCur!=o?"<!--LangHide1-->":"")+'<span class="lang'+o.toUpperCase()+'" style="'+(LangCur==o?"":"display:none")+'">'+i[o]+"</span>"+(LangCur!=o?"<!--LangHide2-->":"");return s},window.LangReview=function(e){var t=$(e||"body");t.find(".langCN")["cn"==LangCur?"show":"hide"](),t.find(".langEN")["cn"!=LangCur?"show":"hide"]();for(var a=t.find(".inputLang"),n=0;n<a.length;n++)a[n].setAttribute("placeholder",a[n].getAttribute("placeholder-"+LangCur))},window.LangClick=function(e){LangCur=e,LangReview(),$(".langBtn").css("color",null),$(".langBtn_"+e).css("color","#000"),$("body").css("wordBreak","cn"==e?"break-all":null),document.titleLang||(document.titleLang=document.title);for(var t=document.titleLang.split("|"),a=[],n=[],r=0;r<t.length;r++)/[^\x00-\xff]/.test(t[r])==("cn"==LangCur)?a.push(t[r].trim()):n.push(t[r].trim());document.title=a.concat(n).join(" | ")},window.CLog=function(e,t,a){for(var n=new Date,r=("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2)+"."+("00"+n.getMilliseconds()).substr(-3),s=["["+r+" "+e+"]"+(a=(a=a.replace(/<!--LangHide1[\S\s]+?LangHide2-->/g,"")).replace(/<[^>]+>/g,""))],i=3;i<arguments.length;i++)s.push(arguments[i]);return(1==t?console.error:3==t?console.warn:4==t?console.debug:console.log).apply(console,s),a},function(){window.$=function(t){return t&&t.is$?t:new e(t)};var e=function(e,t){if(this.length=0,e){if(e.appendChild){this.push(e);return}for(var a=(t||document).querySelectorAll(e),n=0;n<a.length;n++)this.push(a[n])}};e.prototype={is$:1,push:function(e){this[this.length++]=e},find:function(t){var a=this[0];return new e(a?t:"",a)},val:function(e){return this.prop("value",e)},hide:function(){return this.css("display","none")},show:function(e){return this.css("display",void 0===e?null:e)},html:function(e){var t=this[0];if(void 0===e)return t&&t.innerHTML||"";for(var a=0;a<this.length;a++)this[a].innerHTML=e;return this},append:function(e){return this._end(e)},prepend:function(e){return this._end(e,1)},_end:function(e,t){var a=this[0];if(e&&a){var n=e;if("string"==typeof e){var r=document.createElement("div");r.innerHTML=e,n=[];for(var s=0;s<r.childNodes.length;s++)n.push(r.childNodes[s])}else e.appendChild&&(n=[e]);t&&(t=a.firstChild);for(var s=0;s<n.length;s++)t?a.insertBefore(n[s],t):a.appendChild(n[s])}return this},prop:function(e,t){var a=this[0];if(void 0===t)return a&&a[e];for(var n=0;n<this.length;n++)this[n][e]=t;return this},attr:function(e,t){var a=this[0];if(void 0===t)return a&&a.getAttribute(e);for(var n=0;n<this.length;n++)null==t?this[n].removeAttribute(e):this[n].setAttribute(e,t);return this},css:function(e,t){for(var a=0;a<this.length;a++)this[a].style[e]=t;return this},bind:function(e,t){for(var a=0;a<this.length;a++)this[a].addEventListener(e,t);return this}}}(),window.FormatText=function(e){return e.replace(/[&<>='"]/g,function(e){return"&#"+e.charCodeAt(0)+";"})},window.Str2Bytes=function(e){for(var t=new Uint8Array((e=unescape(encodeURIComponent(e))).length),a=0;a<e.length;a++)t[a]=e.charCodeAt(a);return t},window.Bytes2Str=function(e){for(var t="",a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return decodeURIComponent(escape(t))},window.Json2UrlB64=function(e){return Bytes2UrlB64(JSON.stringify(e))},window.Base642Bytes=function(e){for(var t=atob(e),a=new Uint8Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return a},window.UrlB642Bytes=function(e){for(e=e.replace(/_/g,"/").replace(/-/g,"+");e.length%4;)e+="=";return Base642Bytes(e)},window.Bytes2UrlB64=function(e){return Bytes2Base64(e).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")},window.Bytes2Base64=function(e){var t="";if("string"==typeof e)t=unescape(encodeURIComponent(e));else{e instanceof ArrayBuffer&&(e=new Uint8Array(e));for(var a=0;a<e.length;a++)t+=String.fromCharCode(e[a])}return btoa(t)}}(),function(){var msg="";try{window.PageRawHTML=window.PageRawHTML||document.documentElement.outerHTML;var SupportCrypto=!1;eval("SupportCrypto=!!crypto.subtle.sign"),eval("``;(async function(){class a{}})")}catch(e){msg||SupportCrypto||!1!==window.isSecureContext||(msg="no-https"),msg||(msg=SupportCrypto?"browser-old-version":"no-crypto"),window.location.href="/info/errorPage/?msg="+encodeURIComponent(msg);return}$(".main").html($(".main").html()),$("input,textarea,select").attr("autocomplete","off"),$(".main-load").hide(),$(".main").show(),LangClick(LangCur),initMainUI()}()}},4076:function(e,t,a){"use strict";a.r(t);var n=a(5893),r=a(9008),s=a.n(r),i=a(8103),o=a(8841),c=a(7294);t.default=()=>((0,c.useEffect)(()=>{(0,i.Z)();let e=o.c0.getQuery("domain"),t=o.c0.getQuery("type")||"1";if(e&&t){let a=e.replace(/^(https?:\/\/)?/,""),n="";if("1"===t){let e=a.split(",")[0].replace(/^www\./,"");n="*.".concat(e,", ").concat(e).split("*.*.").filter(Boolean).join("")}else n=a;setTimeout(()=>{document.querySelector("#x-q-domain").value=n},100)}window.addEventListener("storage",function(e){"q-acmeAccountKey"===e.key&&(document.querySelector(".in_accountKey").value=e.newValue)});let a=localStorage.getItem("q-acmeAccountKey"),n=document.querySelector(".in_accountKey");if(a&&""!==a)setTimeout(function(){n.value=a},500),n.value=a;else{document.querySelector('input[name="choice_accountKey"][value="generateECC"]').click();let e=setInterval(()=>{n.value&&(localStorage.setItem("q-acmeAccountKey",n.value),clearInterval(e))},100)}let r=document.getElementById("q-privateKey-userInput");setTimeout(()=>{document.querySelector('input[name="choice_privateKey"][value="generateRSA"]').click()},1e3),document.getElementById("q-privateKey-auto").addEventListener("change",function(){document.querySelector('input[name="choice_privateKey"][value="generateRSA"]').click(),r.style.display="none"}),document.getElementById("q-privateKey-ecc").addEventListener("change",function(){document.querySelector('input[name="choice_privateKey"][value="generateECC"]').click(),r.style.display="none"}),document.getElementById("q-privateKey-rsa").addEventListener("change",function(){document.querySelector('input[name="choice_privateKey"][value="generateRSA"]').click(),r.style.display="none"}),document.getElementById("q-privateKey-user").addEventListener("change",function(){document.querySelector('input[name="choice_privateKey"][value="manual"]').click(),r.style.display="",r.addEventListener("blur",function(){setTimeout(()=>{document.querySelector(".in_privateKey").value=r.value},50)})});let s=!1;document.querySelectorAll("input").forEach(function(e){e.addEventListener("input",function(){s=!0})}),window.addEventListener("beforeunload",function(e){s&&((e||window.event).returnValue="你所做的更改可能未保存。")});let c=document.querySelectorAll("#x-q-domain, #x-q-email");(function(){c.forEach(e=>{e.value=localStorage.getItem(e.id)||""})})(),c.forEach(e=>{e.addEventListener("input",()=>{localStorage.setItem(e.id,e.value)})}),document.querySelector(".step1-main-btn").addEventListener("click",function(){let e=document.getElementById("x-q-domain").value,t=localStorage.getItem("q-domainArray");-1===(t=t?JSON.parse(t):[]).indexOf(e)&&(t.push(e),localStorage.setItem("q-domainArray",JSON.stringify(t)))});let l=localStorage.getItem("q-domainArray");l&&JSON.parse(l).forEach(function(e){let t=document.createElement("option");t.value=e,document.getElementById("x-q-domain-datalist").appendChild(t)});let d=document.querySelector(".txt_downloadKey"),u=document.querySelector(".txt_downloadCert");document.getElementById("x-q-copy-textpem").addEventListener("click",function(){o.c0.copy(u.value)}),document.getElementById("x-q-copy-textkey").addEventListener("click",function(){o.c0.copy(d.value)})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s(),{children:(0,n.jsx)("title",{children:"申请证书 | ".concat(o.c0.title)})}),(0,n.jsxs)(o.T3,{children:[(0,n.jsx)("span",{id:"tagid",children:"apply"}),(0,n.jsx)("h1",{className:"display-5 mb-2",children:"申请证书"}),(0,n.jsxs)("p",{className:"mb-5 fs-14",children:["需要帮助吗？ ZeoSeven 提供了 ",(0,n.jsx)("a",{href:"../documents/",target:"_blank",children:"文档"})," 和 ",(0,n.jsx)("a",{href:"https://www.bilibili.com/video/BV1KRBuYrEjo/",rel:"noopener",target:"_blank",children:"视频"})," 。"]}),(0,n.jsxs)("div",{id:"q-steps1",children:[(0,n.jsxs)("div",{className:"d-none",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_acmeURL",value:"https://acme-v02.api.letsencrypt.org/directory",desckey:"descLetsEncrypt"}),"Let's Encrypt"]})}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("input",{className:"in_acmeURL inputLang form-control q-form","placeholder-cn":"请填写证书颁发机构 ACME 服务 URL",style:{border:"#9914ff 1px solid"}}),(0,n.jsx)("button",{className:"mainBtn mainBtnMin btn-q",onClick:()=>{acmeReadDirClick()},children:(0,n.jsx)("span",{className:"langCN",children:"重新检测"})})]})]}),(0,n.jsx)(o.c0.Loading,{}),(0,n.jsx)("div",{className:"acmeReadDirState"})]}),(0,n.jsxs)("div",{id:"q-steps2",style:{display:"none"},children:[(0,n.jsx)("div",{className:"step2Hide step1Show",children:(0,n.jsx)(o.c0.Loading,{text:"等待 ..."})}),(0,n.jsxs)("div",{className:"step1Hide step2Show",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"x-q-domain",children:"域名"}),(0,n.jsx)("input",{id:"x-q-domain",list:"x-q-domain-datalist",className:"in_domains inputLang form-control q-form","placeholder-cn":"example.org, *.example.org"}),(0,n.jsx)("datalist",{id:"x-q-domain-datalist"}),(0,n.jsxs)("p",{className:"fs-12",children:["多域名证书或其它域名输入问题可参阅 ",(0,n.jsx)("a",{href:"../documents/#域名",target:"_blank",children:"文档 - 域名"})," 。"]})]}),(0,n.jsxs)("div",{className:"form-check d-none",children:[(0,n.jsx)("input",{className:"form-check-input choice_domains_store",type:"checkbox",id:"q-steps2-checkbox1"}),(0,n.jsx)("label",{className:"form-check-label",htmlFor:"q-steps2-checkbox1",children:"在此浏览器记住输入的域名"})]}),(0,n.jsxs)("div",{className:"d-none",children:[(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_accountKey",value:"generateRSA"}),(0,n.jsx)("span",{children:"立即创建账户 RSA 私钥"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_accountKey",value:"generateECC"}),(0,n.jsx)("span",{children:"立即创建账户 ECC 私钥"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_accountKey",value:"manual"}),(0,n.jsx)("span",{className:"ms-2",children:"输入账户私钥"})]}),(0,n.jsx)("div",{className:"accountKeyBox mb-2",children:(0,n.jsx)("textarea",{className:"in_accountKey inputLang","placeholder-cn":"..."})}),(0,n.jsx)("div",{className:"accountKeyState fs-12 d-none"}),(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_privateKey",value:"generateRSA"}),(0,n.jsx)("span",{className:"ms-2",children:"创建 RSA 证书私钥"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_privateKey",value:"generateECC"}),(0,n.jsx)("span",{className:"ms-2",children:"创建 ECC 证书私钥"})]}),(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"radio",name:"choice_privateKey",value:"manual"}),(0,n.jsx)("span",{className:"ms-2",children:"输入证书私钥"})]}),(0,n.jsx)("div",{className:"privateKeyBox mb-2",children:(0,n.jsx)("textarea",{className:"in_privateKey inputLang","placeholder-cn":"..."})}),(0,n.jsx)("div",{className:"privateKeyState fs-12 d-none"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"x-q-email",children:"电子邮箱地址"}),(0,n.jsxs)("div",{className:"FlexBox",children:[(0,n.jsxs)("div",{className:"FlexItem",children:[(0,n.jsx)("input",{className:"in_email inputLang form-control q-form",id:"x-q-email","placeholder-cn":"name@example.org"}),(0,n.jsxs)("div",{className:"form-check d-none",children:[(0,n.jsx)("input",{className:"form-check-input choice_email_store",type:"checkbox",id:"q-steps2-checkbox4"}),(0,n.jsx)("label",{className:"form-check-label",htmlFor:"q-steps2-checkbox4",children:"记住邮箱地址"})]})]}),(0,n.jsx)("p",{className:"fs-12",children:"这用于 Let's Encrypt 为你发送证书即将过期的邮件。"})]})]}),(0,n.jsx)("p",{className:"no-a",children:(0,n.jsx)("a",{"data-bs-toggle":"collapse",href:"#g",role:"button","aria-expanded":"false","aria-controls":"g",children:"高级选项"})}),(0,n.jsx)("div",{className:"collapse",id:"g",children:(0,n.jsxs)("div",{className:"mt-3",children:[(0,n.jsx)("p",{children:"证书类型(私钥)"}),(0,n.jsx)("input",{type:"radio",name:"q-privateKey",id:"q-privateKey-auto",value:"auto",className:"d-none",defaultChecked:!0}),(0,n.jsx)("label",{htmlFor:"q-privateKey-auto",className:"label-radio",children:"自动"}),(0,n.jsx)("input",{type:"radio",name:"q-privateKey",id:"q-privateKey-ecc",value:"ecc",className:"d-none"}),(0,n.jsxs)("label",{htmlFor:"q-privateKey-ecc",className:"label-radio",children:["ECC",(0,n.jsx)("span",{className:"fs-12",children:" (效率推荐)"})]}),(0,n.jsx)("input",{type:"radio",name:"q-privateKey",id:"q-privateKey-rsa",value:"rsa",className:"d-none"}),(0,n.jsxs)("label",{htmlFor:"q-privateKey-rsa",className:"label-radio",children:["RSA",(0,n.jsx)("span",{className:"fs-12",children:" (兼容性推荐)"})]}),(0,n.jsx)("input",{type:"radio",name:"q-privateKey",id:"q-privateKey-user",value:"rsa",className:"d-none"}),(0,n.jsx)("label",{htmlFor:"q-privateKey-user",className:"label-radio",children:"自定义"}),(0,n.jsx)("div",{className:"mt-2 mb-3",children:(0,n.jsx)("textarea",{style:{display:"none"},id:"q-privateKey-userInput",className:"form-control q-form fs-14",rows:"5",placeholder:"输入证书私钥 ..."})}),(0,n.jsx)("p",{children:"ACME 账户私钥"}),(0,n.jsx)("input",{type:"radio",id:"q-accountKey-auto",className:"d-none",defaultChecked:!0}),(0,n.jsx)("label",{htmlFor:"q-accountKey-auto",className:"label-radio",children:"自动"}),(0,n.jsxs)("a",{href:"../settings/",target:"_blank",className:"label-radio",children:[(0,n.jsx)("span",{children:"前往设置 "}),(0,n.jsx)("span",{className:"fs-12",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",fill:"currentColor",className:"bi bi-box-arrow-up-right",viewBox:"0 0 16 16",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"})]})})]})]})}),(0,n.jsxs)("div",{className:"itemBox eabShow d-none",children:[(0,n.jsxs)("div",{className:"pd Bold",children:[(0,n.jsx)("span",{className:"langCN",children:"EAB 凭据："}),(0,n.jsx)("span",{className:"langEN"})]}),(0,n.jsxs)("div",{className:"pd",children:[(0,n.jsx)("span",{className:"langCN",children:"当前 ACME 服务要求提供外部账号绑定凭据 (ExternalAccount Binding)，比如 ZeroSSL ：你可以在 ZeroSSL 的管理控制台的 Developer 中获得此凭据，所以你需要先注册一个 ZeroSSL的账号。"}),(0,n.jsx)("span",{className:"langEN"})]}),(0,n.jsxs)("div",{className:"FlexBox",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("i",{className:"must",children:"*"}),"EAB KID:"]}),(0,n.jsx)("div",{className:"FlexItem",children:(0,n.jsx)("input",{className:"in_eab_kid inputLang","placeholder-cn":"请填写EAB KID","placeholder-en":"Please fill in EAB KID"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("i",{className:"must",children:"*"}),"HMAC KEY:"]}),(0,n.jsx)("div",{className:"FlexItem",children:(0,n.jsx)("input",{className:"in_eab_key inputLang","placeholder-cn":"请填写EAB HMAC KEY","placeholder-en":"Please fill in EAB HMAC KEY"})})]})]}),(0,n.jsx)("div",{className:"pd termsAgreeBox d-none",children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",className:"choice_termsAgree",defaultChecked:!0}),(0,n.jsx)("span",{className:"termsAgreeTips"})]})}),(0,n.jsxs)("div",{className:"Center text-end mt-5",children:[(0,n.jsxs)("button",{className:"mainBtn btn btn-q step1-main-btn",onClick:()=>{configStepClick()},children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",className:"bi bi-lightning-fill",viewBox:"0 0 16 16",children:(0,n.jsx)("path",{d:"M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641z"})}),(0,n.jsxs)("span",{className:"ms-2",children:["继续 ",(0,n.jsx)("em",{children:"Go!"})]})]}),(0,n.jsxs)("div",{className:"fs-12",children:[(0,n.jsx)("span",{children:"点击继续后代表你同意 "}),(0,n.jsx)("a",{href:"https://letsencrypt.org/documents/LE-SA-v1.4-April-3-2024.pdf",target:"_blank",rel:"nofollow noreferrer noopener",children:"Let's Encrypt 使用条款"})," 。",(0,n.jsxs)("p",{children:["来自 ",(0,n.jsx)("a",{href:"https://letsencrypt.org/",target:"_blank",children:"Let's Encrypt"})," 的 90 天 TLS 证书。"]})]})]}),(0,n.jsx)("div",{className:"configStepState fw-bold mt-2 fs-14"})]})]}),(0,n.jsxs)("div",{id:"q-steps3",style:{display:"none"},children:[(0,n.jsx)("h2",{className:"fw-light mb-2",children:"最后一步，验证域名所有权"}),(0,n.jsxs)("p",{className:"mb-2",children:["这是可信 CA 颁发证书所必需的阶段，您可能需要： ",(0,n.jsx)("a",{href:"/documents/#验证域名所有权",target:"_blank",children:"文档 - 验证域名所有权"})," 。"]}),(0,n.jsx)("div",{className:"step3Hide step2Show step1Show",children:(0,n.jsx)("div",{className:"itemBox",children:(0,n.jsx)(o.c0.Loading,{text:"等待 ..."})})}),(0,n.jsxs)("div",{className:"step1Hide step2Hide step3Show",children:[(0,n.jsx)("div",{className:"verifyBox"}),(0,n.jsxs)("div",{className:"itemBox",children:[(0,n.jsxs)("div",{className:"Center text-center",children:[(0,n.jsxs)("span",{className:"mainBtn verifyStepBtn btn btn-q fw-bold me-3",onClick:()=>{verifyStepClick()},children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",className:"bi bi-cpu",viewBox:"0 0 16 16",children:(0,n.jsx)("path",{d:"M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0m-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5z"})}),(0,n.jsx)("span",{className:"ms-2 langCN",children:"开始验证！"})]}),(0,n.jsxs)("span",{className:"mainBtn verifyRunStopBtn btn btn-red fw-bold me-3",onClick:()=>{verifyRunStopClick()},children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",className:"bi bi-x-square",viewBox:"0 0 16 16",children:(0,n.jsx)("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"})}),(0,n.jsx)("span",{className:"ms-2 langCN",children:"取消 ..."})]}),(0,n.jsxs)("button",{className:"mainBtn btn btn-red fw-bold me-3",onClick:()=>{configStepClick()},children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",className:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"}),(0,n.jsx)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"})]}),(0,n.jsx)("span",{className:"ms-2",children:"重试 ..."})]}),(0,n.jsxs)("div",{className:"alert alert-warning mt-3 fs-13",role:"alert",children:[(0,n.jsx)("p",{children:"开始验证前请确保所有 DNS 记录或文件都已准备就绪，建议准备就绪后等待 30 秒后再点击。"}),(0,n.jsx)("p",{children:"重试将刷新验证所需信息，需要重新设置 DNS 记录或文件。"})]})]}),(0,n.jsx)("div",{className:"verifyStepState fw-bold mt-2"})]})]})]}),(0,n.jsxs)("div",{id:"q-steps4",style:{display:"none"},children:[(0,n.jsx)("div",{className:"step4Hide step3Show step2Show step1Show",children:(0,n.jsx)("div",{className:"itemBox",children:(0,n.jsx)(o.c0.Loading,{})})}),(0,n.jsxs)("div",{className:"step1Hide step2Hide step3Hide step4Show",children:[(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("div",{className:"col-12 mb-3",children:[(0,n.jsx)("h2",{className:"fw-light mb-4",children:"结果输出"}),(0,n.jsxs)("p",{className:"mb-3 fs-14",children:["证书的 PEM 和 KEY 已经保存到 ",(0,n.jsx)("a",{href:"../manage/",children:"证书管理"}),"，您可能需要：",(0,n.jsx)("a",{href:"../documents/#安装在服务器 或 CDN",children:"文档 - 安装在服务器 或 CDN"})]})]}),(0,n.jsxs)("div",{className:"col-6 mb-4",children:[(0,n.jsx)("p",{className:"fw-bold m-0",children:"PEM"}),(0,n.jsx)("textarea",{className:"txt_downloadCert form-control q-form mb-2 fs-14",rows:"5",readOnly:!0}),(0,n.jsx)("a",{href:"#",className:"mainBtn",onClick:()=>{downloadBtnClick("Cert")},children:"下载 .pem"}),(0,n.jsx)("span",{className:"mx-2",children:"|"}),(0,n.jsx)("a",{href:"#",id:"x-q-copy-textpem",children:"复制 PEM"})]}),(0,n.jsxs)("div",{className:"col-6 mb-4",children:[(0,n.jsx)("p",{className:"fw-bold m-0",children:"KEY"}),(0,n.jsx)("textarea",{className:"txt_downloadKey form-control q-form mb-2 fs-14",rows:"5",readOnly:!0}),(0,n.jsx)("a",{href:"#",className:"mainBtn",onClick:()=>{downloadBtnClick("Key")},children:"下载 .key"}),(0,n.jsx)("span",{className:"mx-2",children:"|"}),(0,n.jsx)("a",{href:"#",id:"x-q-copy-textkey",children:"复制 KEY"})]}),(0,n.jsx)("div",{className:"col-12 mt-5",children:(0,n.jsx)("p",{className:"text-center",children:(0,n.jsxs)("button",{onClick:()=>{window.location.reload()},className:"btn-q fw-bold",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",className:"bi bi-arrow-clockwise",viewBox:"0 0 16 16",children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),(0,n.jsx)("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})]}),(0,n.jsx)("span",{className:"ms-2",children:"再申请一张！"})]})})})]}),(0,n.jsxs)("div",{className:"itemBox d-none",children:[(0,n.jsxs)("div",{className:"pd Bold",children:[(0,n.jsx)("i",{className:"must",children:"*"}),(0,n.jsx)("span",{className:"langCN",children:"保存记录 LOG 文件："})]}),(0,n.jsx)("div",{className:"pd",children:(0,n.jsx)("span",{className:"langCN",children:"建议下载保存此文件，本记录文件包含了所有数据，包括：证书 PEM 文本、证书私钥PEM文本、账户私钥 PEM 文本、所有配置参数。下次你需要续签新证书时，可以将本记录文件直接拖拽进本页面，会自动填写所有参数。"})}),(0,n.jsxs)("div",{className:"FlexBox",children:[(0,n.jsx)("div",{className:"FlexItem",children:(0,n.jsx)("textarea",{className:"txt_downloadLog",readOnly:!0})}),(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"mainBtn",onClick:()=>{downloadBtnClick("Log")},children:[(0,n.jsx)("span",{className:"langCN",children:"下载保存"}),(0,n.jsx)("span",{className:"langEN"})]})})]})]})]})]})]})]}))}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[888,774,179],function(){return t(6652)}),_N_E=e.O()}]);